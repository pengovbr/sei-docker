CKEDITOR.env.ie&&9>CKEDITOR.env.version&&(Array.prototype.indexOf=function(a,b){for(var c=b||0,d=this.length;c<d;c++)if(this[c]===a)return c;return-1});function cleanAttribute(a){var b=["width","style","moz_resizing","colspan","rowspan"];"TABLE"==a.nodeName?(b.push("class"),b.push("border")):b.push("align");var c=[];a=a.attributes;var d=a.length;if(0<d){for(var e=0;e<d;e++)-1==b.indexOf(a[e].name.toLowerCase())&&c.push(a[e].name);for(b=0;b<c.length;b++)a.removeNamedItem(c[b])}}
function cleanStyle(a){var b="width font-family font-size font-weight text-align border-spacing".split(" "),c=[];a=a.style;var d=a.length;if(CKEDITOR.env.ie&&9>CKEDITOR.env.version)if(0==a.cssText.length)d=0;else var e=a.cssText.split(";"),d=e.length;var f;if(0<d){for(var g=0;g<d;g++)e?(f=e[g].split(":")[0].toLowerCase(),-1!=b.indexOf(f)&&c.push(e[g])):(f=a[g],-1==b.indexOf(f)&&c.push(f));if(e)a.cssText=c.join(";");else for(b=0;b<c.length;b++)a.removeProperty(c[b])}}
function cleanTable(a){"TABLE"==a.nodeName&&(CKEDITOR.env.ie?cleanElement(a.children[0]):cleanElement(a.firstElementChild),cleanAttribute(a),cleanStyle(a))}
function cleanElement(a){var b="P DIV SPAN EM U S SUP SUB STRONG".split(" ");-1!==["THEAD","TBODY","TR","TD","TH"].indexOf(a.nodeName)&&(cleanAttribute(a),cleanStyle(a));CKEDITOR.env.ie?(null!=a.childNodes[0]&&cleanElement(a.childNodes[0]),null!=a.nextSibling&&cleanElement(a.nextSibling)):(null!=a.firstElementChild&&cleanElement(a.firstElementChild),null!=a.nextElementSibling&&cleanElement(a.nextElementSibling));if(-1!==["COLGROUP","COL"].indexOf(a.nodeName))CKEDITOR.env.ie?a.removeNode():a.remove();
else if(-1!==b.indexOf(a.nodeName))if(CKEDITOR.env.ie){for(;null!=a.childNodes[0];)a.parentElement.insertBefore(a.childNodes[0],a);a.removeNode()}else{for(;null!=a.firstChild;)a.parentElement.insertBefore(a.firstChild,a);a.remove()}}
CKEDITOR.plugins.add("tableclean",{requires:["table"],init:function(a){a.addCommand("tableClearFormat",{exec:function(a){a=a.getSelection();var c=a.getRanges(),d=null;(d=a.getSelectedElement())?d=d.getAscendant("table",!0):0<c.length&&(CKEDITOR.env.webkit&&c[0].shrink(CKEDITOR.NODE_ELEMENT),d=c[0].getCommonAncestor(!0).getAscendant("table",!0));this._.selectedElement=d;cleanTable(d.$);d.setAttribute("border","1");d.removeClass("cke_show_border")}});a.addMenuItems&&a.addMenuItems({tableclean:{label:"Limpar Formatação",
command:"tableClearFormat",group:"table",order:4}});a.contextMenu&&a.contextMenu.addListener(function(a,c){return!a||a.isReadOnly()?null:a.hasAscendant("table",1)?{tableclean:CKEDITOR.TRISTATE_OFF}:null})}});